<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Random Dice Magic</title>
<style>
  body, html {
    margin: 0; padding: 0; height: 100%; background: #000;
    display: flex; justify-content: center; align-items: center; flex-direction: column;
    color: white; font-family: sans-serif;
    overflow: hidden;
    user-select: none;
  }
  #dice {
    width: 100px; height: 100px;
    border: 4px solid white;
    border-radius: 10px;
    font-size: 5rem;
    display: flex; justify-content: center; align-items: center;
    background: white;
    color: black;
    cursor: pointer;
    user-select: none;
    transition: transform 0.7s ease-in-out;
  }
  #overlay {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: black;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
  }
  #smallIndicator {
    position: fixed;
    top: 10px; right: 10px;
    width: 20px; height: 20px;
    background: rgba(255,255,255,0.4);
    border-radius: 50%;
    display: none;
  }
  #setupModal {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #222; padding: 20px;
    border-radius: 8px;
    display: none;
    flex-direction: column;
    align-items: center;
  }
  #setupModal label {
    margin-bottom: 10px;
    font-size: 1.2rem;
  }
  #setupModal select {
    font-size: 1.2rem;
    padding: 5px;
    margin-bottom: 10px;
  }
  #setupModal button {
    padding: 8px 15px;
    font-size: 1rem;
    cursor: pointer;
  }
</style>
</head>
<body>

<div id="dice">?</div>
<div id="overlay"></div>
<div id="smallIndicator"></div>

<div id="setupModal">
  <label for="fixedNumber">फिक्स नंबर चुनें (1-6)</label>
  <select id="fixedNumber">
    <option value="1">1</option><option value="2">2</option><option value="3">3</option>
    <option value="4">4</option><option value="5">5</option><option value="6">6</option>
  </select>
  <button id="saveBtn">सेव करें</button>
</div>

<script>
  const dice = document.getElementById('dice');
  const overlay = document.getElementById('overlay');
  const smallIndicator = document.getElementById('smallIndicator');
  const setupModal = document.getElementById('setupModal');
  const fixedNumberSelect = document.getElementById('fixedNumber');
  const saveBtn = document.getElementById('saveBtn');

  let fixedNumber = localStorage.getItem('fixedNumber') || null;
  let setupTapCount = 0;
  let isSetupOpen = false;
  let fixModeActive = false;

  function rollDice(randomRoll = true) {
    overlay.style.opacity = "1";
    let result;
    if (fixModeActive && fixedNumber) {
      result = fixedNumber;
      fixModeActive = false;
      smallIndicator.style.display = 'none';
    } else {
      result = Math.floor(Math.random() * 6) + 1;
    }
    dice.style.transform = `rotate(${360 * 4}deg)`; // simple roll animation
    setTimeout(() => {
      dice.textContent = result;
      overlay.style.opacity = "0";
    }, 700);
  }

  // Tap 5 times to open setup
  dice.addEventListener('click', () => {
    if (isSetupOpen) return;
    setupTapCount++;
    if (setupTapCount === 5) {
      openSetup();
      setupTapCount = 0;
    } else {
      rollDice();
    }
  });

  // Press and hold for 3 seconds to activate fixed number
  let pressTimer;
  dice.addEventListener('mousedown', () => {
    pressTimer = setTimeout(() => {
      if (fixedNumber) {
        fixModeActive = true;
        smallIndicator.style.display = 'block';
      }
    }, 3000);
  });
  dice.addEventListener('mouseup', () => {
    clearTimeout(pressTimer);
  });
  dice.addEventListener('mouseleave', () => {
    clearTimeout(pressTimer);
  });

  saveBtn.addEventListener('click', () => {
    const val = fixedNumberSelect.value;
    localStorage.setItem('fixedNumber', val);
    fixedNumber = val;
    closeSetup();
  });

  function openSetup() {
    isSetupOpen = true;
    setupModal.style.display = 'flex';
    if (fixedNumber) fixedNumberSelect.value = fixedNumber;
  }

  function closeSetup() {
    isSetupOpen = false;
    setupModal.style.display = 'none';
  }

  // Initial dice face
  dice.textContent = '?';

</script>

</body>
</html>
